<style>
    .Cffinit {
        width: 96%;
        height: 96%;
        border: none;
        margin: 2%;
        border-radius: 16px;
        display: none;
    }
</style>

<script>
    function closeCreateCffTab(event) {
        document.getElementById("CreateCffTab").remove();
        document.querySelector(".Cffinit").remove();

        let tab = document.getElementById("RightPaneNav").getElementsByTagName("li")[0];
        showTab(tab);
        
        event.stopPropagation();
    }

    function createCreateCffTab() {
        let activeTab = getActiveTab();
        hideTab(activeTab);

        let existingCffTab = document.getElementById("CreateCffTab");
        if (existingCffTab) {
            showTab(existingCffTab);
            return;
        }

        const frame = document.createElement("iframe");
        frame.classList.add("Cffinit");
        frame.setAttribute("src", "https://citation-file-format.github.io/cff-initializer-javascript/#/start");
        frame.setAttribute("title", "Create CITATION.CFF file");
        frame.setAttribute("allowFullscreen", "false");
        document.querySelector(".RightPaneWindow").appendChild(frame);

        const tab = document.createElement("li");
        tab.setAttribute("onClick", "clickTab(this)");
        tab.setAttribute("data-linked-class", "Cffinit");
        tab.setAttribute("id", "CreateCffTab");
        tab.style.zIndex = 0;
        tab.style.color = "#EAFEED";
        tab.style.backgroundColor = "#0c281e";
        tab.appendChild(document.createTextNode("Create CFF "));
        const i = document.createElement("i");
        i.setAttribute("onClick", "closeCreateCffTab(event)");
        i.setAttribute("style", "margin-left: 0.7em; color: white");
        i.classList.add("fa-solid");
        i.classList.add("fa-x");
        tab.appendChild(i);
        
        document.getElementById("RightPaneNav").appendChild(tab);
        showTab(tab);
    }
</script>
